import{_ as n}from"./imgItem.vue_vue_type_script_setup_true_lang-CjmBtTY7.js";import{c as t,e as l,f as s,o as p}from"./app-Bm1F-R0U.js";const e={class:"prose m-auto slide-enter-content"},i=s(`<h1 id="godot-学习" tabindex="-1">godot 学习 <a class="header-anchor" href="#godot-学习" aria-hidden="true">#</a></h1><p>Godot 是一款通用的 2D 和 3D 游戏引擎，旨在支持各种 的项目。您可以使用它来创建游戏或应用程序，然后可以发布 在桌面或移动设备上，以及在网络上。</p><h2 id="生命周期" tabindex="-1">生命周期 <a class="header-anchor" href="#生命周期" aria-hidden="true">#</a></h2><ul><li><p>_ready()：当节点准备好在场景中使用时。通常用于初始化和准备节点的操作。此时，节点已经在场景树中，并且可以执行初始化的工作。</p></li><li><p>_enter_tree()：当节点首次进入场景树时。通常在这里执行与场景树关联的初始化操作。例如，你可以在这里连接信号或执行其他需要场景树存在的操作。</p></li><li><p>_exit_tree()：当节点从场景树中移除时。通常在这里执行清理和资源释放操作。例如，你可以在这里断开信号连接或释放其他资源。</p></li><li><p>_process(delta)：在每一帧的游戏循环中被调用。这是一个适合进行常规游戏逻辑更新的地方，因为它以每帧的频率被调用。</p></li><li><p>_physics_process(delta)：在每一帧的物理循环中被调用。用于处理与物理相关的逻辑，比如移动、碰撞检测等。通常用于需要与物理引擎交互的游戏逻辑。</p></li><li><p>_draw()：用于自定义绘制节点的外观。在这里，你可以绘制自定义的图形、粒子效果等，以定制节点的外观。这通常用于 2D 节点。</p></li></ul><h2 id="第一个-2d-游戏-demo" tabindex="-1">第一个 2D 游戏 Demo <a class="header-anchor" href="#第一个-2d-游戏-demo" aria-hidden="true">#</a></h2><p>创建一个 <strong>Area2D</strong> 节点对象，是一个 Godot 游戏引擎中的类，它代表一个 2D 区域，通常用于处理 2D 空间中的碰撞和交互。<strong>Area2D</strong> 类具有与物理交互和检测相关的方法和属性。</p><h3 id="创建角色" tabindex="-1">创建角色 <a class="header-anchor" href="#创建角色" aria-hidden="true">#</a></h3><ol><li>extends</li></ol><p><strong>extends Area2D</strong> 是一种声明，它表示你的脚本是一个继承自 <strong>Area2D</strong> 的自定义类</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-gdscript"><span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">extends</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> Area2D</span></span></code></pre><ol start="2"><li>@export</li></ol><p><strong>@export</strong> 是一个装饰器</p><ul><li>标记变量或属性，以使其在 Godot 编辑器的属性检查器中可见。</li><li>允许你在编辑器中为这些属性指定值，而不必在脚本中硬编码它们。</li></ul><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-gdscript"><span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">@export</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> var</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> speed</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#4C9A91;--s-light:#2F798A;"> 400</span></span></code></pre><p>当节点进入场景树时调用该函数，查找游戏窗口大小的好时机</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-gdscript"><span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">func</span><span style="--s-dark:#80A665;--s-light:#59873A;"> _ready</span><span style="--s-dark:#666666;--s-light:#999999;">()</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">:</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">	screen_size</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#B8A965;--s-light:#998418;"> get_viewport_rect</span><span style="--s-dark:#666666;--s-light:#999999;">()</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">size</span></span></code></pre><ol start="3"><li>Input.is_action_pressed()</li></ol><p>检查键盘按键，控制角色上下左右</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-gdscript"><span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">func</span><span style="--s-dark:#80A665;--s-light:#59873A;"> _process</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">delta</span><span style="--s-dark:#666666;--s-light:#999999;">)</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">:</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">	var</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> velocity</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> Vector2</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#4D9375;--s-light:#1E754F;">ZERO</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">	if</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> Input</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">.</span><span style="--s-dark:#B8A965;--s-light:#998418;">is_action_pressed</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">&quot;move_right&quot;</span><span style="--s-dark:#666666;--s-light:#999999;">)</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">:</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">		velocity</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">x</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> +=</span><span style="--s-dark:#4C9A91;--s-light:#2F798A;"> 1</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">	if</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> Input</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">.</span><span style="--s-dark:#B8A965;--s-light:#998418;">is_action_pressed</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">&quot;move_left&quot;</span><span style="--s-dark:#666666;--s-light:#999999;">)</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">:</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">		velocity</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">x</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> -=</span><span style="--s-dark:#4C9A91;--s-light:#2F798A;"> 1</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">	if</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> Input</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">.</span><span style="--s-dark:#B8A965;--s-light:#998418;">is_action_pressed</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">&quot;move_down&quot;</span><span style="--s-dark:#666666;--s-light:#999999;">)</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">:</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">		velocity</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">y</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> +=</span><span style="--s-dark:#4C9A91;--s-light:#2F798A;"> 1</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">	if</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> Input</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">.</span><span style="--s-dark:#B8A965;--s-light:#998418;">is_action_pressed</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">&quot;move_up&quot;</span><span style="--s-dark:#666666;--s-light:#999999;">)</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">:</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">		velocity</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">y</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> -=</span><span style="--s-dark:#4C9A91;--s-light:#2F798A;"> 1</span></span></code></pre><ol start="4"><li>AnimatedSprite2D</li></ol><p>检测玩家移动，播放动画</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-gdscript"><span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">	if</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> velocity</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">.</span><span style="--s-dark:#B8A965;--s-light:#998418;">length</span><span style="--s-dark:#666666;--s-light:#999999;">()</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> &gt;</span><span style="--s-dark:#4C9A91;--s-light:#2F798A;"> 0</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">:</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">		velocity</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> velocity</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">.</span><span style="--s-dark:#B8A965;--s-light:#998418;">normalized</span><span style="--s-dark:#666666;--s-light:#999999;">()</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> *</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> speed</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">		$</span><span style="--s-dark:#C99076;--s-light:#A65E2B;">AnimatedSprite2D</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">.</span><span style="--s-dark:#B8A965;--s-light:#998418;">play</span><span style="--s-dark:#666666;--s-light:#999999;">()</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">	else</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">:</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">		$</span><span style="--s-dark:#C99076;--s-light:#A65E2B;">AnimatedSprite2D</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">.</span><span style="--s-dark:#B8A965;--s-light:#998418;">stop</span><span style="--s-dark:#666666;--s-light:#999999;">()</span></span></code></pre><blockquote><p><strong>$</strong> 是 <strong>get_node()</strong> 的简写。所以在上面的代码中，<strong>$AnimatedSprite2D.play()</strong> 等于 <strong>get_node(“AnimatedSprite2D”).play()</strong></p></blockquote><ol start="5"><li>更新位置</li></ol><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-gdscript"><span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">func</span><span style="--s-dark:#80A665;--s-light:#59873A;"> _process</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">delta</span><span style="--s-dark:#666666;--s-light:#999999;">)</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">:</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">  position</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> +=</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> velocity</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> *</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> delta</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">  position</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> position</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">.</span><span style="--s-dark:#B8A965;--s-light:#998418;">clamp</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">Vector2</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#4D9375;--s-light:#1E754F;">ZERO</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> screen_size</span><span style="--s-dark:#666666;--s-light:#999999;">)</span></span></code></pre><ol start="6"><li>选择动画</li></ol><ul><li>AnimatedSprite2D.flip_v 是否垂直翻转</li><li>AnimatedSprite2D.flip_h 是否水平翻转</li></ul><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-gdscript"><span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;"># 水平方向是否移动</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">if</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> velocity</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">x</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> !=</span><span style="--s-dark:#4C9A91;--s-light:#2F798A;"> 0</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">:</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">  # 选择walk动画</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">	$</span><span style="--s-dark:#C99076;--s-light:#A65E2B;">AnimatedSprite2D</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">animation</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#C98A7D;--s-light:#B56959;"> &quot;walk&quot;</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">  # 垂直方向不翻转</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">	$</span><span style="--s-dark:#C99076;--s-light:#A65E2B;">AnimatedSprite2D</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">flip_v</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> false</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">	# 水平方向根据x的值翻转</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">	$</span><span style="--s-dark:#C99076;--s-light:#A65E2B;">AnimatedSprite2D</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">flip_h</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> velocity</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">x</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> &lt;</span><span style="--s-dark:#4C9A91;--s-light:#2F798A;"> 0</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">elif</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> velocity</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">y</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> !=</span><span style="--s-dark:#4C9A91;--s-light:#2F798A;"> 0</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">:</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">	$</span><span style="--s-dark:#C99076;--s-light:#A65E2B;">AnimatedSprite2D</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">animation</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#C98A7D;--s-light:#B56959;"> &quot;up&quot;</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">	$</span><span style="--s-dark:#C99076;--s-light:#A65E2B;">AnimatedSprite2D</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">flip_v</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> velocity</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">y</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> &gt;</span><span style="--s-dark:#4C9A91;--s-light:#2F798A;"> 0</span></span></code></pre><ol start="7"><li>signal</li></ol><p><strong>signal</strong> 是一种用于创建自定义事件的机制。<strong>signal</strong> 允许你定义和触发自定义事件，以便在游戏中的不同节点之间进行通信和响应。</p><p>生命了一个名为 <strong>hit</strong> 的自定义事件，当玩家发生碰撞时，执行 <strong>hit.emit()</strong> 通知响应，为结束游戏做准备。</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-gdscript"><span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">signal</span><span style="--s-dark:#80A665;--s-light:#59873A;"> hit</span></span></code></pre><ol start="8"><li>_on_body_entered</li></ol><p><strong>_on_body_entered</strong> 是 <strong>Area2D</strong> 或 <strong>RigidBody2D</strong> 自带的信号处理函数，用于处理物理碰撞事件。</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-gdscript"><span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">func</span><span style="--s-dark:#80A665;--s-light:#59873A;"> _on_body_entered</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">body</span><span style="--s-dark:#666666;--s-light:#999999;">)</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">:</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">  # 隐藏玩家节点</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">	hide</span><span style="--s-dark:#666666;--s-light:#999999;">()</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">  # 通知hit事件，结束游戏</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">	hit</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">.</span><span style="--s-dark:#B8A965;--s-light:#998418;">emit</span><span style="--s-dark:#666666;--s-light:#999999;">()</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">	$</span><span style="--s-dark:#C99076;--s-light:#A65E2B;">CollisionShape2D</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">.</span><span style="--s-dark:#B8A965;--s-light:#998418;">set_deferred</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">&quot;disabled&quot;</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> true</span><span style="--s-dark:#666666;--s-light:#999999;">)</span></span></code></pre><p>为了防止多次出发 hit 事件，发生碰撞之后应该禁用玩家的碰撞。</p><p>这里不能直接对 <strong>disabled</strong> 赋值，因为不能在物理回调上更改物理属性，需要使用 <strong>set_deferred</strong> 进行异步更改</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-"><span class="line"><span># 异步执行属性更改，表示碰撞发生</span></span>
<span class="line"><span># 必须异步执行，不能在物理回调上更改物理属性</span></span>
<span class="line"><span>$CollisionShape2D.set_deferred(&quot;disabled&quot;, true)</span></span>
<span class="line"><span>$CollisionShape2D.disabled = true</span></span></code></pre><h3 id="创建敌人" tabindex="-1">创建敌人 <a class="header-anchor" href="#创建敌人" aria-hidden="true">#</a></h3><ol><li>RigidBody2D</li></ol><p>2D 物理实体，它不能直接控制，你必须对它施加力（重力、脉冲等），物理模拟将计算由此产生的运动、旋转、对碰撞的反应，并影响其路径中的其他物理物体。</p><ul><li>添加节点 <ul><li>AnimatedSprite2D 包含多个纹理作为动画播放的帧的精灵节点。</li><li>CollisionShape2D 碰撞检测</li><li>VisibleOnScreenNotifier2D 检测节点扩展数据块何时在屏幕上可见。</li></ul></li></ul><p>在 RigidBody2D 的 Collision 取消 Mask，将确保敌人节点不会相互碰撞</p>`,43),r=s(`<ol start="2"><li>选择动画</li></ol><p>获取动画名，随机播放</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-gdscript"><span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">extends</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> RigidBody2D</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">func</span><span style="--s-dark:#80A665;--s-light:#59873A;"> _ready</span><span style="--s-dark:#666666;--s-light:#999999;">()</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">:</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">	var</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> mob_types</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> $</span><span style="--s-dark:#C99076;--s-light:#A65E2B;">AnimatedSprite2D</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">sprite_frames</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">.</span><span style="--s-dark:#B8A965;--s-light:#998418;">get_animation_names</span><span style="--s-dark:#666666;--s-light:#999999;">()</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">	$</span><span style="--s-dark:#C99076;--s-light:#A65E2B;">AnimatedSprite2D</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">.</span><span style="--s-dark:#B8A965;--s-light:#998418;">play</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">mob_types</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">[</span><span style="--s-dark:#B8A965;--s-light:#998418;">randi</span><span style="--s-dark:#666666;--s-light:#999999;">()</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> %</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> mob_types</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">.</span><span style="--s-dark:#B8A965;--s-light:#998418;">size</span><span style="--s-dark:#666666;--s-light:#999999;">()</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">]</span><span style="--s-dark:#666666;--s-light:#999999;">)</span></span></code></pre><ol><li>VisibleOnScreenNotifier2D</li></ol><p>连接 screen_exited 信号，检测节点已经离开屏幕时，删除自己。</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-gdscript"><span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">func</span><span style="--s-dark:#80A665;--s-light:#59873A;"> _on_visible_on_screen_notifier_2d_screen_exited</span><span style="--s-dark:#666666;--s-light:#999999;">()</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">:</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">	queue_free</span><span style="--s-dark:#666666;--s-light:#999999;">()</span></span></code></pre><h3 id="游戏主场景" tabindex="-1">游戏主场景 <a class="header-anchor" href="#游戏主场景" aria-hidden="true">#</a></h3><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-gdscript"><span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">extends</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> Node</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;"># 向编辑器导出一个变量，在编辑器中设置为 mob 场景</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">@export</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> var</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> mob_scene</span><span style="--s-dark:#666666;--s-light:#999999;">:</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> PackedScene</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">var</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> score</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;"># 结束游戏，连接玩家节点的hit信号</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">func</span><span style="--s-dark:#80A665;--s-light:#59873A;"> game_over</span><span style="--s-dark:#666666;--s-light:#999999;">()</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">:</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">	$</span><span style="--s-dark:#C99076;--s-light:#A65E2B;">ScoreTimer</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">.</span><span style="--s-dark:#B8A965;--s-light:#998418;">stop</span><span style="--s-dark:#666666;--s-light:#999999;">()</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">	$</span><span style="--s-dark:#C99076;--s-light:#A65E2B;">MobTimer</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">.</span><span style="--s-dark:#B8A965;--s-light:#998418;">stop</span><span style="--s-dark:#666666;--s-light:#999999;">()</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">	$</span><span style="--s-dark:#C99076;--s-light:#A65E2B;">HUD</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">.</span><span style="--s-dark:#B8A965;--s-light:#998418;">show_game_over</span><span style="--s-dark:#666666;--s-light:#999999;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;"># 游戏开始，连接开始button</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">func</span><span style="--s-dark:#80A665;--s-light:#59873A;"> new_game</span><span style="--s-dark:#666666;--s-light:#999999;">()</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">:</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">	get_tree</span><span style="--s-dark:#666666;--s-light:#999999;">()</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">.</span><span style="--s-dark:#B8A965;--s-light:#998418;">call_group</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">&quot;mobs&quot;</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#C98A7D;--s-light:#B56959;"> &quot;queue_free&quot;</span><span style="--s-dark:#666666;--s-light:#999999;">)</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">	score</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#4C9A91;--s-light:#2F798A;"> 0</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">	$</span><span style="--s-dark:#C99076;--s-light:#A65E2B;">Player</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">.</span><span style="--s-dark:#B8A965;--s-light:#998418;">start</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#4D9375;--s-light:#1E754F;">$</span><span style="--s-dark:#C99076;--s-light:#A65E2B;">StartPosition</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">position</span><span style="--s-dark:#666666;--s-light:#999999;">)</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">	$</span><span style="--s-dark:#C99076;--s-light:#A65E2B;">StartTimer</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">.</span><span style="--s-dark:#B8A965;--s-light:#998418;">start</span><span style="--s-dark:#666666;--s-light:#999999;">()</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">	$</span><span style="--s-dark:#C99076;--s-light:#A65E2B;">HUD</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">.</span><span style="--s-dark:#B8A965;--s-light:#998418;">update_score</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">score</span><span style="--s-dark:#666666;--s-light:#999999;">)</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">	$</span><span style="--s-dark:#C99076;--s-light:#A65E2B;">HUD</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">.</span><span style="--s-dark:#B8A965;--s-light:#998418;">show_message</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">&quot;Get Ready&quot;</span><span style="--s-dark:#666666;--s-light:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">func</span><span style="--s-dark:#80A665;--s-light:#59873A;"> _on_score_timer_timeout</span><span style="--s-dark:#666666;--s-light:#999999;">()</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">:</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">	score</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> +=</span><span style="--s-dark:#4C9A91;--s-light:#2F798A;"> 1</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">	$</span><span style="--s-dark:#C99076;--s-light:#A65E2B;">HUD</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">.</span><span style="--s-dark:#B8A965;--s-light:#998418;">update_score</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">score</span><span style="--s-dark:#666666;--s-light:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">func</span><span style="--s-dark:#80A665;--s-light:#59873A;"> _on_start_timer_timeout</span><span style="--s-dark:#666666;--s-light:#999999;">()</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">:</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">	$</span><span style="--s-dark:#C99076;--s-light:#A65E2B;">MobTimer</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">.</span><span style="--s-dark:#B8A965;--s-light:#998418;">start</span><span style="--s-dark:#666666;--s-light:#999999;">()</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">	$</span><span style="--s-dark:#C99076;--s-light:#A65E2B;">ScoreTimer</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">.</span><span style="--s-dark:#B8A965;--s-light:#998418;">start</span><span style="--s-dark:#666666;--s-light:#999999;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">func</span><span style="--s-dark:#80A665;--s-light:#59873A;"> _on_mob_timer_timeout</span><span style="--s-dark:#666666;--s-light:#999999;">()</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">:</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">	# 创建一个Mob场景的新实例</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">	var</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> mob</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> mob_scene</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">.</span><span style="--s-dark:#B8A965;--s-light:#998418;">instantiate</span><span style="--s-dark:#666666;--s-light:#999999;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">	# 在Path2D上选择一个随机位置</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">	var</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> mob_spawn_location</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#80A665;--s-light:#59873A;"> get_node</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#C99076;--s-light:#A65E2B;">&quot;MobPath/MobSpawnLocation&quot;</span><span style="--s-dark:#666666;--s-light:#999999;">)</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">	mob_spawn_location</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">progress_ratio</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#B8A965;--s-light:#998418;"> randf</span><span style="--s-dark:#666666;--s-light:#999999;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">	# 设置敌人的方向垂直于路径方向</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">	var</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> direction</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> mob_spawn_location</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">rotation</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> +</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> PI</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> /</span><span style="--s-dark:#4C9A91;--s-light:#2F798A;"> 2</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">	# 将敌人的位置设置为随机位置</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">	mob</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">position</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> mob_spawn_location</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">position</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">	# 在方向上添加一些随机性</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">	direction</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> +=</span><span style="--s-dark:#B8A965;--s-light:#998418;"> randf_range</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#CB7676;--s-light:#AB5959;">-</span><span style="--s-dark:#4D9375;--s-light:#1E754F;">PI</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> /</span><span style="--s-dark:#4C9A91;--s-light:#2F798A;"> 4</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> PI</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> /</span><span style="--s-dark:#4C9A91;--s-light:#2F798A;"> 4</span><span style="--s-dark:#666666;--s-light:#999999;">)</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">	mob</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">rotation</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> direction</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">	# 为敌人选择速度</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">	var</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> velocity</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> Vector2</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#B8A965;--s-light:#998418;">randf_range</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#4C9A91;--s-light:#2F798A;">150.0</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#4C9A91;--s-light:#2F798A;"> 250.0</span><span style="--s-dark:#666666;--s-light:#999999;">),</span><span style="--s-dark:#4C9A91;--s-light:#2F798A;"> 0.0</span><span style="--s-dark:#666666;--s-light:#999999;">)</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">	mob</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">linear_velocity</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> velocity</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">.</span><span style="--s-dark:#B8A965;--s-light:#998418;">rotated</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">direction</span><span style="--s-dark:#666666;--s-light:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">	# 通过将其添加到主场景中来生成敌人</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">	add_child</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">mob</span><span style="--s-dark:#666666;--s-light:#999999;">)</span></span></code></pre>`,8),A={__name:"godot",setup(d){return(g,h)=>{const a=n;return p(),t("div",e,[i,l(a,{src:"/images/blog/godot_RigidBody2D_Collision.png"}),r])}}};export{A as default};
//# sourceMappingURL=godot-BbGL370X.js.map
